<?php

/**
 * Hotel Front-Office Solution
 *
 * LICENSE
 *
 * This source file is subject to license that is bundled
 * with this package in the file docs/LICENSE.txt.
 *
 * @author 		BH-TECK Inc. 2009-2010
 * @version		$Id$
 */

/**
 * Names
 *
 * El objetivo es partir nombres a apellidos - nombres
 *
 */
class Names extends UserComponent
{

	private static $_allNames = array(
		//A
		'ADAM' => 1,
		'ADRIA' => 1,
		'ADAM' => 1,
		'ALIRIO' => 1,
		'ANABELA' => 1,
		'ARIANA' => 1,
		'ALDO' => 1,
		'ANDRE' => 1,
		'ANDRES' => 1,
		'ANDREA' => 1,
		'ANDREW' => 1,
		'ANDREINA' => 1,
		'ARLEX' => 1,
		'ARACELLY' => 1,
		'ARACELY' => 1,
		'ANA' => 1,
		'ADOLFO' => 1,
		'ABRAHAM' => 1,
		'ALEJANDRO' => 1,
		'ALEJANDRA' => 1,
		'ARMANDO' => 1,
		'ALVARO' => 1,
		'ANTONIO' => 1,
		'ARTURO' => 1,
		'ANDERSSON' => 1,
		'ALEX' => 1,
		'ALEXIS' => 1,
		'ALEXYS' => 1,
		'ALEXIA' => 1,
		'ALEXANDRA' => 1,
		'ALEXANDER' => 1,
		'ALAIN' => 1,
		'ARIEL' => 1,
		'ALFREDO' => 1,
		'ALBERTO' => 1,
		'ALBEIRO' => 1,
		'ADRIANA' => 1,
		'ANGEL' => 1,
		'ANGELA' => 1,
		'ANGELO' => 1,
		'ALAN' => 1,
		'ALLAN' => 1,
		'ANGELICA' => 1,
		'ANGELINA' => 1,
		'ASTRID' => 1,
		'AURA' => 1,
		'AUGUSTO' => 1,
		'ARTHUR' => 1,
		'ARELIS' => 1,
		'ATILIO' => 1,
		'ADINA' => 1,
		'ALISA' => 1,
		'ASUNCION' => 1,
		'ANCIZAR' => 1,
		'AGUSTIN' => 1,
		'AMELIA' => 1,
		'ASHLEY' => 1,
		'ABEL' => 1,
		'ALBA' => 1,
		'ALEGRIA' => 1,
		'ARGIRIO' => 1,
		'ALINA' => 1,
		'ALICIA' => 1,
		'ALICE' => 1,
		'ATILIO' => 1,
		'AURA' => 1,
		'ALFONSO' => 1,
		//B
		'BERNARDO' => 1,
		'BERNARDA' => 1,
		'BLADIMIR' => 1,
		'BLASIMIR' => 1,
		'BRIGITTE' => 1,
		'BRENDA' => 1,
		'BLANCA' => 1,
		'BRYAN' => 1,
		'BRIAN' => 1,
		'BRUCE' => 1,
		'BERNABE' => 1,
		'BERENICE' => 1,
		'BEATRIZ' => 1,
		'BIBIANA' => 1,
		'BRITANNY' => 1,
		'BYRON' => 1,
		'BORIS' => 1,
		//C
		'CANDY' => 1,
		'CANDYMAR' => 1,
		'CENAIDA' => 1,
		'CAROLINA' => 1,
		'CARLOS' => 1,
		'CESAR' => 1,
		'CAMILO' => 1,
		'CAMILA' => 1,
		'CLAUDIA' => 1,
		'CECILIA' => 1,
		'CHARLES' => 1,
		'CLARA' => 1,
		'CARMEN' => 1,
		'CARMENZA' => 1,
		'CONNY' => 1,
		'CINDY' => 1,
		'CARLA' => 1,
		'CIELO' => 1,
		'CRISTIAN' => 1,
		'CRISTHIAN' => 1,
		'CHRISTIAN' => 1,
		'CRISTINA' => 1,
		'CHRISTINA' => 1,
		'CATALINA' => 1,
		'CONSTANZA' => 1,
		'CATHERIN' => 1,
		'CATHERINE' => 1,
		'CARIDAD' => 1,
		'CHIARA' => 1,
		'CARMELO' => 1,
		//D
		'DOUGLAS' => 1,
		'DILMARBELIS' => 1,
		'DEIBIS' => 1,
		'DALILA' => 1,
		'DARLYN' => 1,
		'DOLLY' => 1,
		'DANNY' => 1,
		'DANIEL' => 1,
		'DANIELA' => 1,
		'DANIELLA' => 1,
		'DIEGO' => 1,
		'DIANA' => 1,
		'DAVID' => 1,
		'DANILO' => 1,
		'DAYANA' => 1,
		'DARMAN' => 1,
		'DENISSE' => 1,
		'DIONISIO' => 1,
		'DAISY' => 1,
		'DAISSY' => 1,
		'DEISI' => 1,
		'DEISY' => 1,
		'DARIO' => 1,
		'DANILO' => 1,
		'DOLORES' => 1,
		'DORIS' => 1,
		'DORA' => 1,
		'DALBJERG' => 1,
		//E
		'ESTELLER' => 1,
		'ESTHER' => 1,
		'ESTER' => 1,
		'ELIZABETH' => 1,
		'ELIAS' => 1,
		'EDGAR' => 1,
		'EDGARDO' => 1,
		'ERIKA' => 1,
		'EDUARDO' => 1,
		'EDUARD' => 1,
		'EDUAR' => 1,
		'EDWARD' => 1,
		'ERNESTO' => 1,
		'ENRIQUE' => 1,
		'EDISON' => 1,
		'EDISSON' => 1,
		'EMILIO' => 1,
		'EDNA' => 1,
		'EIDA' => 1,
		'EDGARDO' => 1,
		'ESPERANZA' => 1,
		'ESTEBAN' => 1,
		'ELENA' => 1,
		'EDWIN' => 1,
		'EILEEN' => 1,
		'ERIK' => 1,
		'ERIC' => 1,
		'ESTEFANIA' => 1,
		'ESTEFANI' => 1,
		'ESTEFANY' => 1,
		'ESTELLA' => 1,
		'EDER' => 1,
		'ENITH' => 1,
		'ERLYZETH' => 1,
		'ELKIN' => 1,
		'EVELIN' => 1,
		'EVELYN' => 1,
		'EUFEMIA' => 1,
		'ERICK' => 1,
		'EDNA' => 1,
		'ENZO' => 1,
		'EDZENIA' => 1,
		'EFREN' => 1,
		'ELIO' => 1,
		'EMILDER' => 1,
		'ELIANA' => 1,
		'ELVIRA' => 1,
		'ELVIS' => 1,
		'ESPARTACO' => 1,
		'EVELIO' => 1,
		'EVELIA' => 1,
		//F
		'FERMIN' => 1,
		'FERNEY' => 1,
		'FERNANDO' => 1,
		'FERNANDA' => 1,
		'FREDDY' => 1,
		'FREDY' => 1,
		'FRAN' => 1,
		'FRANN' => 1,
		'FRANK' => 1,
		'FELIPE' => 1,
		'FABIAN' => 1,
		'FABIANA' => 1,
		'FAVIO' => 1,
		'FABIO' => 1,
		'FABIOLA' => 1,
		'FRANCESCA' => 1,
		'FRANCISCO' => 1,
		'FRANCISCA' => 1,
		'FRANCIS' => 1,
		'FEDERICO' => 1,
		'FRED' => 1,
		'FLORALBA' => 1,
		'FLOR' => 1,
		'FLORA' => 1,
		'FLORIA' => 1,
		'FLORIO' => 1,
		'FATIMA' => 1,
		//G
		'GUILLERMO' => 1,
		'GERMAN' => 1,
		'GERARDO' => 1,
		'GUSTAVO' => 1,
		'GLORIA' => 1,
		'GRACE' => 1,
		'GREGORIO' => 1,
		'GRISELDA' => 1,
		'GISEL' => 1,
		'GISELLE' => 1,
		'GEORGE' => 1,
		'GLADYS' => 1,
		'GLADIS' => 1,
		'GINA' => 1,
		'GABRIEL' => 1,
		'GABRIELA' => 1,
		'GIAN' => 1,
		'GIANCARLO' => 1,
		'GIOVANNY' => 1,
		'GIOVANY' => 1,
		'GIOVANNI' => 1,
		'GIOVANI' => 1,
		'GIOVANA' => 1,
		'GIOVANNA' => 1,
		'GRACE' => 1,
		'GRETA' => 1,
		//H
		'HARRY' => 1,
		'HANS' => 1,
		'HANNAH' => 1,
		'HILARY' => 1,
		'HAROL' => 1,
		'HAROLD' => 1,
		'HEIDY' => 1,
		'HEIDI' => 1,
		'HEIDY' => 1,
		'HERNANDO' => 1,
		'HERNAN' => 1,
		'HENRY' => 1,
		'HELEN' => 1,
		'HELENA' => 1,
		'HORTENSIA' => 1,
		'HORACIO' => 1,
		'HEBER' => 1,
		'HECTOR' => 1,
		'HOLLMAN' => 1,
		'HOLMAN' => 1,
		'HERMES' => 1,
		'HUMBERTO' => 1,
		'HELMUTH' => 1,
		'HASBLEIDY' => 1,
		'HAZBLEIDY' => 1,
		'HUGO' => 1,
		//I
		'IGOR' => 1,
		'ISAAC' => 1,
		'IRENE' => 1,
		'IBETTE' => 1,
		'IGNACIA' => 1,
		'IGNACIO' => 1,
		'ISA' => 1,
		'ISABEL' => 1,
		'ISABELLA' => 1,
		'ISABELA' => 1,
		'INGRID' => 1,
		'INGRYD' => 1,
		'INGRI' => 1,
		'INGRY' => 1,
		'IVAN' => 1,
		'ISRAEL' => 1,
		'ISAAC' => 1,
		'ILIANA' => 1,
		'IVONNE' => 1,
		//J
		'JEAN' => 1,
		'JASON' => 1,
		'JEISSON' => 1,
		'JEISON' => 1,
		'JOHNSON' => 1,
		'JHONSON' => 1,
		'JHONSSON' => 1,
		'JAIR' => 1,
		'JAIRO' => 1,
		'JAMES' => 1,
		'JAIME' => 1,
		'JUAN' => 1,
		'JAVIER' => 1,
		'JOSE' => 1,
		'JULIAN' => 1,
		'JULIANA' => 1,
		'JOAQUIN' => 1,
		'JORGE' => 1,
		'JUANA' => 1,
		'JUANITA' => 1,
		'JULIO' => 1,
		'JULIA' => 1,
		'JULIE' => 1,
		'JOHN' => 1,
		'JHON' => 1,
		'JIMENA' => 1,
		'JOHANA' => 1,
		'JOHANNA' => 1,
		'JOHAN' => 1,
		'JHOAN' => 1,
		'JOAO' => 1,
		'JESSICA' => 1,
		'JESSI' => 1,
		'JEIDY' => 1,
		'JESSY' => 1,
		'JESUS' => 1,
		'JEAN' => 1,
		'JOSEFINA' => 1,
		'JONNY' => 1,
		'JONATHAN' => 1,
		'JHONATAN' => 1,
		'JOHNNATAN' => 1,
		'JOHNATTAN' => 1,
		'JONATAN' => 1,
		'JOSEPH' => 1,
		'JENIFER' => 1,
		'JENNIFER' => 1,
		'JAQUELINE' => 1,
		'JANETH' => 1,
		'JANET' => 1,
		'JONNY' => 1,
		'JHONNY' => 1,
		'JHEFFERSON' => 1,
		'JEFERSON' => 1,
		'JEFFERSON' => 1,
		'JEFERSSON' => 1,
		'JACOBO' => 1,
		'JISELA' => 1,
		'JISELLA' => 1,
		'JOENMARYS' => 1,
		'JOCELYN' => 1,
		//K
		'KIRSTEN' => 1,
		'KRISTI' => 1,
		'KARLA' => 1,
		'KAROL' => 1,
		'KAROLINA' => 1,
		'KATALINA' => 1,
		'KARINA' => 1,
		'KARINY' => 1,
		'KATERINE' => 1,
		'KATHERINE' => 1,
		'KAREN' => 1,
		'KELLY' => 1,
		'KARIN' => 1,
		'KATIA' => 1,
		'KSTHRIN' => 1,
		//L
		'LAURA' => 1,
		'LADY' => 1,
		'LEIDY' => 1,
		'LEYDY' => 1,
		'LUCIA' => 1,
		'LEONOR' => 1,
		'LEONILDE' => 1,
		'LEONARDO' => 1,
		'LIONARDO' => 1,
		'LUDWIG' => 1,
		'LUCAS' => 1,
		'LILIAN' => 1,
		'LILIANA' => 1,
		'LUIS' => 1,
		'LUISA' => 1,
		'LINA' => 1,
		'LINNA' => 1,
		'LIZETH' => 1,
		'LISCETH' => 1,
		'LISETH' => 1,
		'LISED' => 1,
		'LUZ' => 1,
		'LINDA' => 1,
		'LEANDRO' => 1,
		'LISANDRO' => 1,
		'LESLY' => 1,
		'LESLIE' => 1,
		'LORENA' => 1,
		'LILIBETH' => 1,
		'LILLY' => 1,
		//M
		'MICHAEL' => 1,
		'MAYKER' => 1,
		'MAYER' => 1,
		'MARISSA' => 1,
		'MARILYN' => 1,
		'MARILY' => 1,
		'MAIRA' => 1,
		'MAYRA' => 1,
		'MAIRO' => 1,
		'MARCELO' => 1,
		'MARCELA' => 1,
		'MARCY' => 1,
		'MARCEL' => 1,
		'MARIBELL' => 1,
		'MARIBEL' => 1,
		'MARYORY' => 1,
		'MARYURYS' => 1,
		'MARYURIS' => 1,
		'MARY' => 1,
		'MARYBELL' => 1,
		'MAGNOLIA' => 1,
		'MAGNOLIO' => 1,
		'MARIO' => 1,
		'MARIA' => 1,
		'MAGDA' => 1,
		'MANUEL' => 1,
		'MAGALY' => 1,
		'MAGDY' => 1,
		'MARTA' => 1,
		'MARTHA' => 1,
		'MARTIN' => 1,
		'MASSIMILIANO' => 1,
		'MAXIMILIANO' => 1,
		'MAXIMO' => 1,
		'MASSIMO' => 1,
		'MONICA' => 1,
		'MONICO' => 1,
		'MARGARA' => 1,
		'MARGARITA' => 1,
		'MARGARRET' => 1,
		'MARCO' => 1,
		'MARCOS' => 1,
		'MARK' => 1,
		'MAURICIO' => 1,
		'MELISSA' => 1,
		'MELISA' => 1,
		'MILENA' => 1,
		'MIGUEL' => 1,
		'MAURO' => 1,
		'MICHELLE' => 1,
		'MICHEL' => 1,
		'MARISOL' => 1,
		'MIRYAM' => 1,
		'MIRIAM' => 1,
		'MIREYA' => 1,
		'MIRILIS' => 1,
		'MEGAN' => 1,
		'MATHIAS' => 1,
		'MABEL' => 1,
		//N
		'NILSA' => 1,
		'NANNY' => 1,
		'NANCY' => 1,
		'NADIA' => 1,
		'NALIA' => 1,
		'NELSON' => 1,
		'NELZA' => 1,
		'NATALIA' => 1,
		'NATHALIA' => 1,
		'NATALI' => 1,
		'NATALY' => 1,
		'NATHALY' => 1,
		'NORA' => 1,
		'NORBERTO' => 1,
		'NATHALIE' => 1,
		'NADIA' => 1,
		'NICOLAS' => 1,
		'NICOLASA' => 1,
		'NICOLE' => 1,
		'NICOL' => 1,
		'NICOLAU' => 1,
		'NESTOR' => 1,
		'NELLY' => 1,
		'NORA' => 1,
		'NORY' => 1,
		'NURY' => 1,
		'NUBIA' => 1,
		'NAYIBE' => 1,
		'NAZARETH' => 1,
		'NOEL' => 1,
		//O
		'OSWALDO' => 1,
		'OSCAR' => 1,
		'OMAR' => 1,
		'OLGA' => 1,
		'ORMARY' => 1,
		'ORLANDO' => 1,
		'ORANGEL' => 1,
		'ONY' => 1,
		'OLIVER' => 1,
		//P
		'PIERRE' => 1,
		'PATRICK' => 1,
		'PATRICIO' => 1,
		'PATRIZIA' => 1,
		'PATRICIA' => 1,
		'PEDRO' => 1,
		'PABLO' => 1,
		'PAUL' => 1,
		'PAULO' => 1,
		'PAULA' => 1,
		'PILAR' => 1,
		'PAOLO' => 1,
		'PHILLIP' => 1,
		'PHILIP' => 1,
		'PAULUS' => 1,
		'PETER' => 1,
		'PATTY' => 1,
		//R
		'ROSMERY' => 1,
		'REGULO' => 1,
		'ROSA' => 1,
		'RUTH' => 1,
		'RENE' => 1,
		'RENZO' => 1,
		'RUBEN' => 1,
		'ROMEL' => 1,
		'ROMELA' => 1,
		'RODOLFO' => 1,
		'ROCIO' => 1,
		'RONAL' => 1,
		'RONALD' => 1,
		'RICARDO' => 1,
		'RICHARD' => 1,
		'RICHARDO' => 1,
		'ROBERTO' => 1,
		'ROBERTA' => 1,
		'ROBERT' => 1,
		'ROSVELT' => 1,
		'RAMON' => 1,
		'RAMIRO' => 1,
		'RANDY' => 1,
		'RODRIGO' => 1,
		'RIGOBERTO' => 1,
		'ROMINA' => 1,
		'RUBI' => 1,
		'RUBY' => 1,
		//S
		'SAILE' => 1,
		'SANTIAGO' => 1,
		'SANDRA' => 1,
		'SILVIO' => 1,
		'SILVIA' => 1,
		'SILVINA' => 1,
		'SILVANA' => 1,
		'SIMON' => 1,
		'SIMONA' => 1,
		'SONIA' => 1,
		'SANDY' => 1,
		'SINDY' => 1,
		'SERGIO' => 1,
		'SHARON' => 1,
		'STEFANY' => 1,
		'STEFANNY' => 1,
		'STEPHANY' => 1,
		'SEBASTIAN' => 1,
		'SUSANA' => 1,
		'SAMIR' => 1,
		'SARA' => 1,
		'SARAH' => 1,
		'SHIRLEY' => 1,
		'STELLA' => 1,
		'SOFIA' => 1,
		'SOL' => 1,
		'SUSANA',
		'SUSAN',
		//U,
		'URIEL' => 1,
		//V
		'VIVIANE' => 1,
		'VALERIA' => 1,
		'VERONICA' => 1,
		'VIOLETA' => 1,
		'VICTOR' => 1,
		'VICTORIA' => 1,
		'VICKY' => 1,
		'VIANOR' => 1,
		'VANESA' => 1,
		'VANESSA' => 1,
		'VIVIANA' => 1,
		'VIVIEN' => 1,
		'VIRGINIA' => 1,
		'VICENTE' => 1,
		'VILMA' => 1,
		'VALENTINA' => 1,
		'VALENTINO' => 1,
		//T
		'TATIANA' => 1,
		'TITO' => 1,
		'TOMAS' => 1,
		'THOMAS' => 1,
		'TANIA' => 1,
		'TULIO' => 1,
		'TERESA' => 1,
		//W
		'WILLIAM' => 1,
		'WILIAM' => 1,
		'WILIAN' => 1,
		'WILLIAN' => 1,
		'WALTER' => 1,
		'WILSON' => 1,
		'WOLFGANG' => 1,
		'WISTON' => 1,
		'WENDY' => 1,
		'WELY' => 1,
		//Y
		'YANCI' => 1,
		'YELIRENE' => 1,
		'YASMIN' => 1,
		'YGOR' => 1,
		'YANDRY' => 1,
		'YASLY' => 1,
		'YASMIL' => 1,
		'YADIRA' => 1,
		'YOSANDRA' => 1,
		'YOHANA' => 1,
		'YOHANNA' => 1,
		'YOJANA' => 1,
		'YOLANDA' => 1,
		'YAMILE' => 1,
		'YECID' => 1,
		'YENNY' => 1,
		'YEIMI' => 1,
		'YEYMY' => 1,
		'YESICA' => 1,
		'YESSICA' => 1,
		'YULI' => 1,
		'YULY' => 1,
		'YUDY' => 1,
		'YULIBELL' => 1,
		'YAMID' => 1,
		'YANETH' => 1,
		'YAQUELINE' => 1,
		'YINETH' => 1,
		'YUBER' => 1,
		'YULDOR' => 1,
		'YEFERSON' => 1,
		'YEFFERSON' => 1,
		'YEFERSSON' => 1,
		'YUCELY' => 1,
		'YISELA' => 1,
		'YENMYS' => 1,
		'YELIMAR' => 1,
		'YUBIRI' => 1,
		//X
		'XAVIER' => 1,
		'XIMENA' => 1,
		'XIME' => 1,
		'XIOMI' => 1,
		'XIOMARA' => 1,
		'XUHE' => 1,
		//Z
		'ZAIDA' => 1,
		'ZULIA' => 1,
		'ZOILA' => 1,
	);

	protected static function _repairNames($nombre){
		if(count($nombre)>=4){
			if(isset(self::$_allNames[$nombre[1]])){
				$primerApellido = $nombre[0];
				$segundoApellido = '';
				$primerNombre = $nombre[1];
				$segundoNombre = join(' ', array_slice($nombre, 2, count($nombre)-2));
			} else {
				$primerApellido = $nombre[0];
				$segundoApellido = $nombre[1];
				$primerNombre = $nombre[2];
				$segundoNombre = join(' ', array_slice($nombre, 3, count($nombre)-3));
			}
		} else {
			if(count($nombre)==3){
				if(isset(self::$_allNames[$nombre[1]])){
					$primerApellido = $nombre[0];
					$segundoApellido = '';
					$primerNombre = $nombre[1];
					$segundoNombre = $nombre[2];
				} else {
					$primerApellido = $nombre[0];
					$segundoApellido = $nombre[1];
					$primerNombre = $nombre[2];
					$segundoNombre = '';
				}
			} else {
				if(count($nombre)==2){
					$primerApellido = $nombre[0];
					$segundoApellido = '';
					$primerNombre = $nombre[1];
					$segundoNombre = '';
				} else {
					$primerApellido = $nombre[0];
					$segundoApellido = '';
					$primerNombre = '';
					$segundoNombre = '';
				}
			}
		}
		return array($primerApellido, $segundoApellido, $primerNombre, $segundoNombre);
	}

	static function getParts($cliente_nombre){
		$nombre = preg_split('/ /', preg_replace('/[ ]+/', ' ', trim($cliente_nombre)));
		$i = count($nombre)-1;
		while($i>=0){
			if( in_array($nombre[$i], array('DE', 'DE LA', 'DI', 'III', 'II', 'DI', 'DEL', 'DE EL', 'DEN', 'DIEZ', 'DOS', 'DO', 'DA', 'DER', 'VAN', 'VAN DER', 'VAN DEN', 'LE', 'MC', 'MAC', 'D', 'AL') ) ){

				if (isset($nombre[($i+1)])) {
					$nombre[($i+1)] = $nombre[$i].' '.$nombre[($i+1)];

					unset($nombre[$i]);
					$tNombre = array();

					$k = 0;
					foreach ($nombre as $nom)
					{
						$tNombre[$k] = $nom;
						++$k;
					}

					unset($nombre);
					$nombre = $tNombre;
				}

			} else {
				$i--;
			}
		}
		$nombre = self::_repairNames($nombre);
		if(count($nombre)>=4){
			$primerApellido = $nombre[0];
			$segundoApellido = $nombre[1];
			$primerNombre = $nombre[2];
			$segundoNombre = join(' ', array_slice($nombre, 3, count($nombre)));
		} else {
			if(count($nombre)==3){
				$primerApellido = $nombre[0];
				$segundoApellido = $nombre[1];
				$primerNombre = $nombre[2];
				$segundoNombre = '';
			} else {
				$primerApellido = $nombre[0];
				$segundoApellido = '';
				$primerNombre = $nombre[1];
				$segundoNombre = '';
			}
		}
		return array(
			'primerApellido' => $primerApellido,
			'segundoApellido' => $segundoApellido,
			'primerNombre' => $primerNombre,
			'segundoNombre' => $segundoNombre
		);
	}

	function shortName($nombre){
		$parts = hfos_names_part($nombre);
		$primerNombre = explode(' ', $parts['nombres']);
		return $parts['primer'].' '.$primerNombre[0];
	}

}
